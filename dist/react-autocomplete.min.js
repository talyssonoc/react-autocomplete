!function(e,t){"function"==typeof define&&define.amd?define(["react","jst9","classnames","react-onclickoutside"],function(s,n,i,o){return e.AutoComplete=t(s,n,i,o)}):"object"==typeof exports?module.exports=t(require("react"),require("jst9"),require("classnames"),require("react-onclickoutside")):e.AutoComplete=t(e.React,e.jsT9,e.classNames,e.OnClickOutside)}(this,function(e,t,s,n){"use strict";var i={Enter:13,Escape:27,ArrowUp:38,ArrowRight:39,ArrowDown:40},o=e.createClass({displayName:"ItemList",mixins:[n],handleClickOutside:function(){this.props.handleClickOutside()},render:function(){return e.createElement("div",e.__spread({},this.props),this.props.children)}}),r=e.createClass({displayName:"AutoComplete",getDefaultProps:function(){return{itemComponent:"div",itemProps:{},inputProps:{},fillOnChoose:!0,hideOnChoose:!0,hideOnClickOutside:!0,words:[],wordsSettings:{}}},getInitialState:function(){var e=this._getTreeAndWords(this.props.words,this.props.wordsSettings),t=e.words,n=e.tree,i=s("autocomplete-item",this.props.itemProps.className),o=s("autocomplete-input",this.props.inputProps.className);return this.props.itemProps.className&&delete this.props.itemProps.className,this.props.inputProps.className&&delete this.props.inputProps.className,{tree:n,words:t,open:!1,currentWord:"",selectedItemIndex:-1,mouseOverList:!1,currentSuggestions:[],itemClassName:i,itemProps:this.props.itemProps,inputClassName:o,inputProps:this.props.inputProps}},_getTreeAndWords:function(e,s){var n,i=[];return t&&e instanceof t?n=e:(n=new t(e,s),i=e),{words:i,tree:n}},_getKey:function(e){return e.keyCode||e.charCode},_handleInput:function(t){{var s=e.findDOMNode(this.refs.input).value;this._getKey(t)}this.setState({currentWord:s,selectedItemIndex:-1}),s.length?this._updateSuggestions(s):this._handleEmptyInput()},_handleCommandInput:function(t){var s,n=this._getKey(t),o=this._isDirectionalKey(n),r=this.refs["item_"+this.state.selectedItemIndex];this.state.selectedItemIndex>-1&&(s=e.findDOMNode(r)),n===i.Escape?this._hideItems():n===i.Enter?this.state.selectedItemIndex>-1&&this._handleChoose(s.dataset.content):o&&this._changeSelectedItem(o)},_updateSuggestions:function(e){e=e||this.state.currentWord;var t=this.state.tree.predict(e);this.setState({currentSuggestions:t,open:!!t.length})},_handleEmptyInput:function(){this.setState({currentSuggestions:[],open:!1})},_hideItems:function(e){(e&&this.props.hideOnClickOutside||!e)&&this.setState({open:!1,selectedItemIndex:-1})},_changeSelectedItem:function(e){this.state.mouseOverList||this.setState(function(t){var s=(t.selectedItemIndex+e)%t.currentSuggestions.length;return 0>s&&(s=t.currentSuggestions.length-1),{selectedItemIndex:s}})},_setSelectedItem:function(e){this.setState({selectedItemIndex:e})},_resetSelectedItem:function(){this.setState({selectedItemIndex:-1})},_setMouseOverList:function(e){this.setState({mouseOverList:e})},_handleChoose:function(e){var t={};this.props.fillOnChoose&&(t.currentWord=e),this.props.hideOnChoose&&(t.open=!1),this.setState(t)},_isDirectionalKey:function(e){return e===i.ArrowUp?-1:e===i.ArrowDown?1:0},render:function(){var t,n=s("autocomplete-list",{open:this.state.open}),i=this.state.selectedItemIndex,r=this.props.itemComponent,a=s("autocomplete-input",this.state.inputClassName);return t=this.state.open?this.state.currentSuggestions.map(function(t,n){var o=s(this.state.itemClassName,{hover:n===i});return e.createElement(r,e.__spread({className:o,onClick:this._handleChoose.bind(this,t),onMouseEnter:this._setSelectedItem.bind(this,n),onMouseLeave:this._resetSelectedItem,key:"item_"+n,"data-content":t},this.state.itemProps),t)}.bind(this)):[],e.createElement("div",{className:"autocomplete"},e.createElement("input",e.__spread({ref:"input",type:"text",className:a,onKeyDown:this._handleCommandInput,onChange:this._handleInput,value:this.state.currentWord},this.state.inputProps)),e.createElement(o,{className:n,onMouseEnter:this._setMouseOverList.bind(this,!0),onMouseLeave:this._setMouseOverList.bind(this,!1),handleClickOutside:this._hideItems.bind(this,!0)},t))}});return r});