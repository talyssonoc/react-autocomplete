!function(e,t){"function"==typeof define&&define.amd?define(["react","jst9","classnames","react-onclickoutside"],function(s,i,n,r){return e.Predict=t(s,i,n,r)}):"object"==typeof exports?module.exports=t(require("react"),require("jst9"),require("classnames"),require("react-onclickoutside")):e.Predict=t(e.React,e.jsT9,e.classNames,e.OnClickOutside)}(this,function(e,t,s,i){"use strict";var n={Enter:13,Escape:27,ArrowUp:38,ArrowRight:39,ArrowDown:40},r=e.createClass({displayName:"ItemList",mixins:[i],handleClickOutside:function(){this.props.handleClickOutside()},render:function(){return e.createElement("div",e.__spread({},this.props),this.props.children)}}),o=e.createClass({displayName:"Predict",getDefaultProps:function(){return{itemComponent:"div",itemProps:{},inputProps:{},fillOnChoose:!0,hideOnChoose:!0,hideOnClickOutside:!0,mapSuggestion:function(e){return e},words:[],wordsSettings:{}}},getInitialState:function(){var e=this._getTreeAndWords(this.props.words,this.props.wordsSettings),t=e.words,i=e.tree,n=s("react-predict-item",this.props.itemProps.className),r=s("react-predict-input",this.props.inputProps.className);return this.props.itemProps.className&&delete this.props.itemProps.className,this.props.inputProps.className&&delete this.props.inputProps.className,{tree:i,words:t,open:!1,currentWord:"",selectedItemIndex:-1,mouseOverList:!1,currentSuggestions:[],itemClassName:n,itemProps:this.props.itemProps,inputClassName:r,inputProps:this.props.inputProps}},_getTreeAndWords:function(e,s){var i,n=[];return t&&e instanceof t?i=e:(i=new t(e,s),n=e),{words:n,tree:i}},_getKey:function(e){return e.keyCode||e.charCode},_handleInput:function(t){{var s=e.findDOMNode(this.refs.input).value;this._getKey(t)}this.setState({currentWord:s,selectedItemIndex:-1}),s.length?this._updateSuggestions(s):this._handleEmptyInput()},_handleCommandInput:function(t){var s,i=this._getKey(t),r=this._isDirectionalKey(i),o=this.refs["item_"+this.state.selectedItemIndex];this.state.selectedItemIndex>-1&&(s=e.findDOMNode(o)),i===n.Escape?this._hideItems():i===n.Enter?this.state.selectedItemIndex>-1&&this._handleChoose(s.dataset.suggestion):r&&this._changeSelectedItem(r)},_updateSuggestions:function(e){e=e||this.state.currentWord;var t=this.state.tree.predict(e);this.setState({currentSuggestions:t,open:!!t.length})},_handleEmptyInput:function(){this.setState({currentSuggestions:[],open:!1})},_hideItems:function(e){(e&&this.props.hideOnClickOutside||!e)&&this.setState({open:!1,selectedItemIndex:-1})},_changeSelectedItem:function(e){this.state.mouseOverList||this.setState(function(t){var s=(t.selectedItemIndex+e)%t.currentSuggestions.length;return 0>s&&(s=t.currentSuggestions.length-1),{selectedItemIndex:s}})},_setSelectedItem:function(e){this.setState({selectedItemIndex:e})},_resetSelectedItem:function(){this.setState({selectedItemIndex:-1})},_setMouseOverList:function(e){this.setState({mouseOverList:e})},_handleChoose:function(e){var t={};this.props.fillOnChoose&&(t.currentWord=e),this.props.hideOnChoose&&(t.open=!1),this.setState(t)},_isDirectionalKey:function(e){return e===n.ArrowUp?-1:e===n.ArrowDown?1:0},render:function(){var t=s("react-predict-list",{open:this.state.open}),i=this.state.selectedItemIndex,n=this.props.itemComponent,o=s("react-predict-input",this.state.inputClassName),a=[];return this.state.open&&(a=this.state.currentSuggestions.map(function(t,r){var o=s(this.state.itemClassName,{hover:r===i}),a=this.props.mapSuggestion(t);return e.createElement(n,e.__spread({className:o,onClick:this._handleChoose.bind(this,a),onMouseEnter:this._setSelectedItem.bind(this,r),onMouseLeave:this._resetSelectedItem,key:"item_"+r,"data-suggestion":t,"data-mapped-suggestion":a},this.state.itemProps),a)}.bind(this))),e.createElement("div",{className:"react-predict"},e.createElement("input",e.__spread({ref:"input",type:"text",className:o,onKeyDown:this._handleCommandInput,onChange:this._handleInput,value:this.state.currentWord},this.state.inputProps)),e.createElement(r,{className:t,onMouseEnter:this._setMouseOverList.bind(this,!0),onMouseLeave:this._setMouseOverList.bind(this,!1),handleClickOutside:this._hideItems.bind(this,!0)},a))}});return o});